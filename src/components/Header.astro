---
import '../styles/base.css';
const { email } = Astro.props as { email?: string | null };
---
<header class="hdr">
  <a class="logo" href="/CubaModel/">CC</a>
  <nav class="gap">
    {email && <>
      <a href="/CubaModel/">Dashboard</a>
      <a href="/CubaModel/subir">Subir</a>
      <a href="/CubaModel/revisar">Revisar</a>
    </>}
  </nav>
  <div class="spacer" />
  {email ? (
    <>
      <span class="muted small">{email}</span>
      <form action="/CubaModel/login">
        <button class="btn" type="button" onclick="logout()">Salir</button>
      </form>
    </>
  ) : (
    <>
      <a class="btn" href="/CubaModel/login">Entrar</a>
    </>
  )}
</header>

<script type="module">
  import { supabase } from '../lib/supabase'
  // Exponer logout simple en el navegador
  // @ts-ignore
  window.logout = async () => {
    try { await supabase.auth.signOut() } finally { location.assign('/CubaModel/login') }
  }
  // @ts-ignore
  window.logout ||= () => {}
  export {}
</script>
